/*! For license information please see peach-collector-1.x.min.js.LICENSE */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("PeachCollector",[],t):"object"==typeof exports?exports.PeachCollector=t():e.PeachCollector=t()}(this,function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(n(15));function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r=function(){function e(t,n,o,r,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._window=t;var u=Math.floor(1e4*Math.random());this.sitekey=o,this.filter=r,this.payload_func=a,this.url=n||"https://pipe-collect.ebu.io/v3/collect?s=".concat(o),this._queue_handler=new i.default(this._window,null,"q-"+u)}return function(e,t,n){t&&o(e.prototype,t),n&&o(e,n)}(e,[{key:"getEventsInQueue",value:function(){return this._queue_handler.read_from_queue()}},{key:"get_collect_url",value:function(){return this.url}},{key:"get_sitekey",value:function(){return this.sitekey}},{key:"get_payload",value:function(e){return"function"==typeof this.payload_func?this.payload_func(e):e}},{key:"apply_payload_func",value:function(e){return this.payload_func&&"function"==typeof this.payload_func?this.payload_func(e):e}},{key:"filter_events",value:function(e){var t=this;if(e){if(this.filter){var n=[];return e.forEach(function(e){t.filter.includes(e.type)&&n.push(e)}),n}return e}return[]}}]),e}();t.default=r,e.exports=t.default},function(e,t,n){"use strict";(function(i){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=_(n(3)),r=_(n(4)),a=_(n(9)),u=_(n(10)),l=_(n(11)),s=_(n(12)),d=(_(n(0)),_(n(16))),c=_(n(17));function _(e){return e&&e.__esModule?e:{default:e}}function f(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var v=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i.window?this._window=i.window:this._window=t&&t.window===window?t:null,this._setup()}return function(e,t,n){t&&f(e.prototype,t),n&&f(e,n)}(e,[{key:"_setup",value:function(){var e=new o.default(this._window),t=new a.default(this._window,e),n=new l.default(this._window,t.get_persistant_cookie_id()),i=new s.default(this._window,e,n,t);return(0,c.default)(this,e,t,n),(0,d.default)(this,i),(0,u.default)(this,e,t),(0,r.default)(this,i.dispatcher(this),e,n,t),this}},{key:"init",value:function(e,t){return this.setAppId(t),this.setCollectEndpoints(e),this}}]),e}();t.default=v,e.exports=t.default}).call(this,n(2))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.do_not_track=!0,this.site_key=void 0,this.user_id=null,t&&t.window===window?this.enabled=0===t.navigator.doNotTrack:this.enabled=!1}return function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(e,[{key:"enable",value:function(){this.enabled=!0,this.do_not_track=!1}},{key:"disable",value:function(){this.enabled=!1,this.do_not_track=!0}},{key:"isEnabled",value:function(){return!(!this.enabled||this.do_not_track)}},{key:"set_user_id",value:function(e){this.user_id=e}},{key:"get_user_id",value:function(){return this.user_id}}]),e}();t.default=o,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,u,s){var d=function(t){var n=e._window&&e._window.location?e._window.location.href:null;return null===t?new o.EventContext(null,null,null,null,null,null,n):t.setCustomField("page_uri",n)};return e.sendCustomEvent=function(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;t(new i.default(e,n,d(o),r,a))},e.sendPageViewEvent=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;r=r||(e._window&&e._window.location?e._window.location.href:null),a=a||(e._window&&e._window.document&&0!==e._window.document.referrer.length?e._window.document.referrer:null);var l=o.EventContext.pageViewContext(a,n);return t(new i.default("page_view",r,d(l),null,u)),e},e.sendReadMoreEvent=function(n){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return t(new i.default("read_more",n,d(o),null,r)),e},e.sendArticleStartEvent=function(n){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return t(new i.default("article_start",n,d(o),null,r)),e},e.sendArticleEndEvent=function(n){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,c=r.EventProps.articleProps(o,a,u);return t(new i.default("article_end",n,d(l),c,s)),e},[["sendMediaPlayEvent","media_play"],["sendMediaPauseEvent","media_pause"],["sendMediaSeekEvent","media_seek"],["sendMediaStopEvent","media_stop"],["sendMediaEndEvent","media_end"],["sendMediaHeartbeatEvent","media_heartbeat"],["sendMediaVideoModeChangedEvent","media_video_mode_changed"],["sendMediaAudioModeChangedEvent","media_audio_mode_changed"],["sendMediaAudioChangedEvent","media_audio_changed"],["sendMediaLikeEvent","media_like"],["sendMediaShareEvent","media_share"]].map(function(n){e[n[0]]=function(u){var s,c,_,f,v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,p=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,m=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if("object"===l(u)&&u.nodeName)c=d(h),_=r.EventProps.propsFromHTMLMediaElement(u),p&&(_=Object.assign(_,p)),f=a.default.metadataFromHTMLMediaElement(u),m&&(f=Object.assign(f,m)),s=v||u.id;else{s=u,c=v;var y=e._window&&e._window.location?e._window.location.href:null;null!==c&&"object"===l(c)?c.setCustomField("page_uri",y):c=new o.EventContext(s,null,null,null,null,null,y),_=h,f=p}return t(new i.default(n[1],s,c,_,f)),e}}),e.propsFromHTMLMediaElement=function(e){return r.EventProps.propsFromHTMLMediaElement(e)},e.metadataFromHTMLMediaElement=function(e){return a.default.metadataFromHTMLMediaElement(e)},e.pageViewContext=function(e,t){return o.EventContext.pageViewContext(e,t)},e.readMoreContext=function(e,t){return o.EventContext.readMoreContext(e,t)},e.mediaContext=function(e,t,n,i,r,a){return o.EventContext.mediaContext(e,t,n,i,r,a)},e.recommendationContext=function(e,t,n,i,r,a,u){return o.EventContext.recommendationContext(e,t,n,i,r,a,u)},e.EventContextComponent=function(e,t,n){return new o.EventContextComponent(e,t,n)},e.EventProps=function(){return new r.EventProps},e.EventMetadata=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return new a.default(e,t,n,i,o)},e.sendRecommendationHitEvent=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,_=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;u=u||(e._window&&e._window.location?e._window.location.href:null);var f=o.EventContext.recommendationContext(null,r,a,s,u,l,c);return t(new i.default("recommendation_hit",n,d(f),null,_)),e},[["sendRecommendationDisplayedEvent","recommendation_displayed"],["sendRecommendationLoadedEvent","recommendation_loaded"]].map(function(n){e[n[0]]=function(r){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,_=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;u=u||(e._window&&e._window.location?e._window.location.href:null),l=l||(e._window&&e._window.document&&0!==e._window.document.referrer.length?e._window.document.referrer:null);var f=o.EventContext.recommendationContext(a,null,null,l,u,s,c);return t(new i.default(n[1],r,d(f),null,_)),e}}),e.createContextComponent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new o.EventContextComponent(e,t,n)},e.setAppId=function(t){return u.set_app_id(t),e},e};var i=u(n(5)),o=n(6),r=n(7),a=u(n(8));function u(e){return e&&e.__esModule?e:{default:e}}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=t,this.id=n,this.event_timestamp=Date.now(),this.context=i,this.props=o,this.metadata=r},e.exports=t.default},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(t,"__esModule",{value:!0}),t.EventContextComponent=t.EventContext=void 0;var r=function(){function e(t,n,o,r,a,u,l,s,d){i(this,e),this.id=t,this.type=n,this.items=o,this.item_id=r,this.hit_index=a,this.referrer=u,this.page_uri=l,this.source=s,this.component=d}return function(e,t,n){t&&o(e.prototype,t),n&&o(e,n)}(e,[{key:"setCustomField",value:function(e,t){return this[e]=t,this}}],[{key:"pageViewContext",value:function(t,n){return new e(n,null,null,null,null,t,null,null,null)}},{key:"readMoreContext",value:function(t,n){return new e(null,null,null,null,null,null,null,t,n)}},{key:"mediaContext",value:function(t,n,i,o,r,a){return new e(t,n,null,null,null,i,o,r,a)}},{key:"recommendationContext",value:function(t,n,i,o,r,a,u){return new e(null,null,t,n,i,o,r,a,u)}}]),e}();t.EventContext=r;t.EventContextComponent=function e(t,n,o){i(this,e),this.type=t,this.name=n,this.version=o}},function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(t,"__esModule",{value:!0}),t.EventProps=void 0;var o=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time_spent_s=null,this.playlist_id=null,this.insert_position=null,this.playback_position_s=null,this.previous_playback_position_s=null,this.is_playing=null,this.video_mode=null,this.audio_mode=null,this.start_mode=null,this.previous_id=null,this.playback_rate=null,this.volume=null,this.completion_ratio=null,this.position_ratio=null,[["setVideoModeBar","video_mode","bar"],["setVideoModeMini","video_mode","mini"],["setVideoModeNormal","video_mode","normal"],["setVideoModeWide","video_mode","wide"],["setVideoModePIP","video_mode","pip"],["setVideoModeFullScreen","video_mode","fullscreen"],["setVideoModeCast","video_mode","cast"],["setVideoModePreview","video_mode","preview"],["setAudioModeNormal","audio_mode","normal"],["setAudioModeMuted","audio_mode","muted"],["setStartModeNormal","start_mode","normal"],["setStartModeAutoPlay","start_mode","auto_play"],["setStartModeAutoContinue","start_mode","auto_continue"]].map(function(e){t[e[0]]=function(){return t[e[1]]=e[2],t}}),[["setPlaylistID","playlist_id"],["setInsertPosition","insert_position"],["setVideoMode","video_mode"],["setAudioMode","audio_mode"],["setStartMode","start_mode"],["setPreviousID","previous_id"]].map(function(e){t[e[0]]=function(n){return t[e[1]]=n,t}}),[["setTimeSpent","time_spent_s"],["setPlaybackPosition","playback_position_s"],["setPreviousPlaybackPosition","previous_playback_position_s"],["setPlaybackRate","playback_rate"],["setVolume","volume"],["setCompletionRatio","completion_ratio"],["setPositionRatio","position_ratio"]].map(function(e){t[e[0]]=function(n){return t[e[1]]=isNaN(n)?null:n,t}})}return function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(e,[{key:"setIsPlaying",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.is_playing="boolean"==typeof e?e:null,this}},{key:"setCustomField",value:function(e,t){return this[e]=t,this}}],[{key:"propsFromHTMLMediaElement",value:function(t){var n=new e;return n.time_spent_s=null,n.playback_position_s=t.currentTime,n.previous_playback_position_s=null,"VIDEO"===t.nodeName&&(n.video_mode="normal"),"AUDIO"===t.nodeName&&(n.audio_mode=t.muted?"muted":"normal"),n.start_mode=t.autoplay?"auto_play":"normal",n.previous_id=null,n.playback_rate=t.playbackRate,n.volume=t.volume,n}},{key:"articleProps",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=new e;return o.time_spent_s=t,o.completion_ratio=n,o.position_ratio=i,o}}]),e}();t.EventProps=o},function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=t,this.format=n||"ondemand",this.episode_id=i,this.show_id=o,this.duration=r}return function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(e,[{key:"setCustomField",value:function(e,t){return this[e]=t,this}}],[{key:"metadataFromHTMLMediaElement",value:function(t){var n=new e;return n.type=t.nodeName.toLowerCase(),n.duration=t.duration,n}}]),e}();t.default=o,e.exports=t.default},function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._window=t,this._name="Cookie",this.cookie_prefix="_pc",this.cookie_domain=null,this.expires=new Date(25353216e5).toUTCString(),this.valid_cookie_names=[this.cookie_prefix+"_c",this.cookie_prefix+"_s",this.cookie_prefix+"_st",this.cookie_prefix+"_t",this.cookie_prefix+"_lr"],this.session_start_time=null,this.cookie_id=null,this.current_timestamp=Date.now(),this.last_recorded_event_timestamp=0,this.inactivity_interval=1800,this._setup(n)}return function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(e,[{key:"_setup",value:function(e){this.get_persistant_cookie_id()||this.set_persistant_cookie_id(),"tracking_enabled"===this.get_tracking_cookie()?(this.set_tracking_cookie("tracking_enabled"),e.enable()):(this.set_tracking_cookie("do_not_track"),e.disable()),this.check_session_length()}},{key:"get_cookie_prefix",value:function(){return this.cookie_prefix}},{key:"set_cookie_prefix",value:function(e){this.cookie_prefix=e}},{key:"get_inactivity_interval",value:function(){return this.inactivity_interval}},{key:"set_inactivity_interval",value:function(e){this.inactivity_interval=e}},{key:"get_cookie_domain",value:function(){return this.cookie_domain}},{key:"set_cookie_domain",value:function(e){this.cookie_domain=e}},{key:"__get_root_tld",value:function(){if(this.cookie_domain)return this.cookie_domain;if(!this._window)return"domain not specified";var e=this._window.location.host.match(/(?:[^.]+\.)?(\w*(?:\.\w*)|localhost|(?:\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}))(:\d*)?$/)||[];return e.length>0?e[1]:"domain not specified"}},{key:"__generateGUID",value:function(){if(void 0!==this._window.crypto&&void 0!==this._window.crypto.getRandomValues){var e=new Uint16Array(8);this._window.crypto.getRandomValues(e);var t=function(e){for(var t=e.toString(16);t.length<4;)t="0"+t;return t};return t(e[0])+t(e[1])+"-"+t(e[2])+"-"+t(e[3])+"-"+t(e[4])+"-"+t(e[5])+t(e[6])+t(e[7])}return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}},{key:"check_session_length",value:function(){var e=this.get_session_start_time()||0,t=this.get_last_recorded_timestamp()||0,n=this.get_inactivity_interval(),i=Date.now();if(e&&0!==t)return i-t>1e3*n?(this.set_last_recorded_timestamp_cookie(),void this.set_session_start_time_cookie()):void 0;this.set_last_recorded_timestamp_cookie(),this.set_session_start_time_cookie()}},{key:"set_last_recorded_timestamp_cookie",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)||this.__get_root_tld();return e||(e=Date.now()),this._window&&(this._window.document.cookie=this.cookie_prefix+"_lr="+e+";path=/"+(t?";domain="+t:"")),this.last_recorded_event_timestamp=e,e}},{key:"set_tracking_cookie",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)||this.__get_root_tld(),n=new Date(25353216e5).toUTCString();return e||(e="do_not_track"),this._window&&(this._window.document.cookie=this.cookie_prefix+"_t="+e+";expires="+n+";path=/"+(t?";domain="+t:"")),e}},{key:"get_tracking_cookie",value:function(){return this.__get_cookie_by_name(this.cookie_prefix+"_t")}},{key:"get_session_start_time",value:function(){var e=this.__get_cookie_by_name(this.cookie_prefix+"_st");return parseInt(e,10)}},{key:"get_last_recorded_timestamp",value:function(){return parseInt(this.__get_cookie_by_name(this.cookie_prefix+"_lr"),10)}},{key:"set_session_start_time_cookie",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=e||Date.now(),n=this.__get_root_tld();return this._window&&(this._window.document.cookie=this.cookie_prefix+"_st="+t+";path=/"+(n?";domain="+n:"")),this.session_start_time=e,t}},{key:"get_persistant_cookie_id",value:function(){return this.__get_cookie_by_name(this.cookie_prefix+"_c")}},{key:"set_persistant_cookie_id",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)||this.__get_root_tld(),n=new Date(25353216e5).toUTCString();return e||(e=this.__generateGUID()),this._window&&(this._window.document.cookie=this.cookie_prefix+"_c="+e+";expires="+n+";path=/"+(t?";domain="+t:"")),this.cookie_id=e,e}},{key:"__get_cookie_by_name",value:function(e){if(this.valid_cookie_names.includes(e)){if(this._window){var t=("; "+this._window.document.cookie).split("; "+e+"=");return 2===t.length&&t.pop().split(";").shift()}return e}return!1}}]),e}();t.default=o,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(!t||!n)return;e.setUserId=function(n){return t.set_user_id(n),e},e.enableTracking=function(){return t.enable(),n.set_tracking_cookie("tracking_enabled"),e},e.disableTracking=function(){return t.disable(),n.set_tracking_cookie("do_not_track"),e},e.isTrackingEnabled=function(){return t.isEnabled()},e.trackMediaEvents=function(t){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u="function"===n?n(t):n,l=[["play","sendMediaPlayEvent","media_play",!0],["pause","sendMediaPauseEvent","media_pause",!0],["seeked","sendMediaSeekEvent","media_seek",!1],["seeking","sendMediaSeekEvent","media_seek",!1],["abort","sendMediaStopEvent","media_stop",!0],["ended","sendMediaEndEvent","media_end",!0],["timeupdate","sendMediaHeartbeatEvent","media_heartbeat",!1]],s=function(t,n,i,o,r,a){var u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;t["on"+n[0]]=u?function(t){u(t)&&e[n[1]](t.currentTarget,i,o,r,a)}:function(t){e[n[1]](t.currentTarget,i,o,r,a)}},d=function(n){var d=l[n];if(d[3]&&s(t,l[n],u,i,o,r),a&&a[d[2]])switch(d[2]){case"media_seek":s(t,l[n],u,i,o,r,function(){return"media_seek"!==e._tracking_latest_event&&(e._tracking_latest_event="media_seek",setTimeout(function(){e._tracking_latest_event=null},1e3),!0)});break;case"media_stop":s(t,l[n],u,i,o,r);break;case"media_heartbeat":s(t,l[n],u,i,o,r,function(t){return!(!a[d[2]].heartbeat_interval||t.target.paused||Math.round(t.target.currentTime)%a[d[2]].heartbeat_interval!=0||e._tracking_latest_event===d[2])&&(e._tracking_latest_event=d[2],setTimeout(function(){e._tracking_latest_event=null},a[d[2]].heartbeat_interval/2*1e3),!0)})}},c=0;c<l.length;c++)d(c);return e}},e.exports=t.default},function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=n,this.app_id=null,this.type="web",t&&(this.device={},this.device.type=t.navigator.userAgent,this.device.vendor=t.navigator.vendor,this.device.model=t.navigator.platform,this.device.language=t.navigator.language,this.device.timezone=(new Date).getTimezoneOffset()/60)}return function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(e,[{key:"set_id",value:function(e){this.id=e}},{key:"get_id",value:function(){return this.id}},{key:"set_app_id",value:function(e){this.app_id=e}},{key:"get_app_id",value:function(){return this.app_id}}]),e}();t.default=o,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(13)),o=a(n(14)),r=a(n(0));function a(e){return e&&e.__esModule?e:{default:e}}function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var l=function(){function e(t,n,i,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._window=t,this.collect_endpoints=[],this.local_storage_prefix="_pc_",this.send_event_callback=null,this._tracking=n,this._client=i,this._cookie=o}return function(e,t,n){t&&u(e.prototype,t),n&&u(e,n)}(e,[{key:"set_collect_endpoints",value:function(e,t){var n=[];Array.isArray(e)?e.forEach(function(e){e.sitekey||e.url?n.push(new r.default(t,e.url,e.sitekey,e.filter,e.payload_func)):console.error("[PEACH-COLLECTOR][ENDPOINT_SETUP] Cannot set up default endpoint without sitekey!")}):"string"==typeof e?n.push(new r.default(t,null,e,null)):console.error("[PEACH-COLLECTOR][ENDPOINT_SETUP] First given init() param is neither an endpoint array nor a site key!"),this.collect_endpoints=n}},{key:"get_collect_endpoints",value:function(){return this.collect_endpoints}},{key:"set_send_event_callback",value:function(e){this.send_event_callback=e}},{key:"dispatcher",value:function(e){var t=this;return function(n){if(t._cookie.set_last_recorded_timestamp_cookie(),t._cookie.check_session_length(),!e.isTrackingEnabled())return!1;t.collect_endpoints.forEach(function(r){var a=new i.default(e._window,t._client,[n],null,t._cookie.get_session_start_time(),t._tracking.get_user_id()),u=r.filter_events(a.events);if(0===u.length)return"";if(a.events=u,a=r.apply_payload_func(a),e._window||r._queue_handler.add_to_queue(a.events),e._window&&e._window.XMLHttpRequest){var l=r._queue_handler.read_from_queue();return l&&l.length>0&&l.map(function(e){a.events.push(e)}),a.set_sitekey(r.sitekey),(0,o.default)(r.url,a,r._queue_handler,t.send_event_callback),a}})}}}]),e}();t.default=l,e.exports=t.default},function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(){function e(t,n,i,o,r){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.peach_schema_version="1.0.3",this.peach_implementation_version="1.0.1",this.site_key=o,this.session_start_timestamp=r||Date.now(),this.sent_timestamp=Date.now(),this.user_id=a||null,this.events=i,this.client=n}return function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(e,[{key:"set_sitekey",value:function(e){this.site_key=e}}]),e}();t.default=o,e.exports=t.default},function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o){var r=new XMLHttpRequest,a=function e(t,n){var o={};return Object.keys(t).forEach(function(r){Array.isArray(t[r])&&n?o[r]=t[r].filter(function(e){return e}):t[r]&&"object"===i(t[r])?o[r]=e(t[r],n):t[r]&&"function"==typeof t[r]||null!==t[r]&&(o[r]=t[r])}),o},u=a(t);u.events=t.events.map(function(e){return a(e,!0)}),r.addEventListener("load",function(){return r.status<200||r.status>=300?(n.add_to_queue(u.events),o&&o({error:r.status,description:r.statusText},null,u),console.log("[PEACH-COLLECTOR][SENDXHR] Send error. "+r.status+" - "+r.statusText),!1):(console.log("[PEACH-COLLECTOR][SENDXHR] Send done."),o&&o(null,this.responseText,u),!0)}),r.addEventListener("error",function(e){console.warn("[PEACH-COLLECTOR][SENDXHR] Send error."),n.add_to_queue(u.events),o&&o({error:e},null)});try{r.open("POST",e,!0),r.setRequestHeader("Content-Type","application/json; charset=UTF-8"),r.send(JSON.stringify(u))}catch(e){n.add_to_queue(u.events),console.warn("[PEACH-COLLECTOR][SENDXHR] failed to send data due to connection issue. Queueing data for later push")}return!0},e.exports=t.default},function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._window=t,this.local_storage_prefix=n||"_pc_",this.queue_name=i||"q",this.events_queue=[]}return function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(e,[{key:"set_queue_name",value:function(e){this.queue_name=e}},{key:"get_queue_name",value:function(){return this.local_storage_prefix+this.queue_name}},{key:"add_to_queue",value:function(e){var t=this;if(e.map(function(e){t.events_queue.push(e)}),this.__isLocalStorageSupported()){var n=this.get_queue_name();localStorage.setItem(n,JSON.stringify(this.events_queue))}}},{key:"reset_event_queue",value:function(){this.events_queue=[],this.__isLocalStorageSupported()&&localStorage.removeItem(this.get_queue_name())}},{key:"read_from_queue",value:function(){var e;if(this.__isLocalStorageSupported()){var t=this.get_queue_name();e=JSON.parse(localStorage.getItem(t))}else e=this.events_queue;return this.reset_event_queue(),e}},{key:"__isLocalStorageSupported",value:function(){if(!this._window)return!1;var e=this.local_storage_prefix+"internal__test__";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}}]),e}();t.default=o,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.setCollectEndpoints=function(n){return t.set_collect_endpoints(n),e},e.setSendEventCallback=function(n){return t.set_send_event_callback(n),e},e._getCollectEndpoints=function(){return t.get_collect_endpoints()},e._getEventsInQueue=function(){var e=[];return t.collect_endpoints.forEach(function(t){t._queue_handler.read_from_queue().forEach(function(t){e.push(t)})}),e}},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,i){e.setInactivityInterval=function(t){return n.set_inactivity_interval(t),e},e.setCookiePrefix=function(t){return n.set_cookie_prefix(t),e},e.setCookieDomain=function(t){return n.set_cookie_domain(t),e},e.setSessionStartTimeCookie=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return n.set_session_start_time_cookie(t),e},e.setPersistantCookieId=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return n.set_persistant_cookie_id(t,i),e}},e.exports=t.default}])});